function doGet(e) {
  try {
    // Get parameters from URL
    var userAgent = e.parameters.userAgent;
    var platform = e.parameters.platform;
    var screenSize = e.parameters.screenSize;
    var language = e.parameters.language;
    var timezone = e.parameters.timezone;
    var timestamp = e.parameters.timestamp;
    
    if (userAgent) {
      // Save to sheet
      var sheetUrl = 'https://docs.google.com/spreadsheets/d/1TfolNrzEspUCZcqllO-JNuiekKgxKvb1NCzUii5Rgbg/edit';
      var sheet = SpreadsheetApp.openByUrl(sheetUrl).getActiveSheet();
      
      // Add headers if first time
      if (sheet.getLastRow() === 0) {
        sheet.getRange(1, 1, 1, 7).setValues([[
          'Timestamp', 'Device Info', 'Platform', 'Screen Size', 'Language', 'Timezone', 'Status'
        ]]);
      }
      
      // Add data
      sheet.appendRow([
        new Date(),
        userAgent,
        platform,
        screenSize,
        language,
        timezone,
        '✅ CAPTURED'
      ]);
      
      Logger.log('✅ Data saved: ' + userAgent);
    }
    
    return ContentService.createTextOutput('Data received successfully');
    
  } catch (error) {
    Logger.log('❌ Error: ' + error.toString());
    return ContentService.createTextOutput('Error: ' + error.toString());
  }
}

function doPost(e) {
  return ContentService.createTextOutput('Use GET method for QR codes');
}
